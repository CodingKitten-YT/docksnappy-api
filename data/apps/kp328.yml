version: '3.8'

services:
  app:
    image: accent/app:latest # Use the official Accent application image from Docker Hub
    ports:
      - "80:80" # Map HTTP port 80 on the host to port 80 in the container (default for web apps)
    depends_on:
      - db
    environment:
      APP_SECRET: "<your_secret_key>" # Replace with your secret key for session security
      DB_HOST: db
      DB_NAME: "<your_db_name>" # Replace with your database name
      DB_USER: "<your_db_user>" # Replace with your database user
      DB_PASSWORD: "<your_db_password>" # Replace with your database password
    volumes:
      - ./app:/code # Mount the local app directory to /code in the container (for source code and changes)

  db:
    image: postgres:13 # Use PostgreSQL 13 official image
    command: --password=false # Disable password authentication for the database (usually configured via environment variables)
    volumes:
      - accent-db:/var/lib/postgresql # Use a named volume to persist database data
    environment:
      POSTGRES_DB: "<your_db_name>" # Replace with your database name
      POSTGRES_USER: "<your_db_user>" # Replace with your database user
      POSTGRES_PASSWORD: "<your_db_password>" # Replace with your database password

  php:
    image: accent/php:latest # Use the official PHP image from Docker Hub
    volumes:
      - ./app:/code # Mount the local app directory to /code in the container (for vendor and cache directories)
    depends_on:
      - app

volumes:
  accent-db:

networks:
  default:
    driver: bridge