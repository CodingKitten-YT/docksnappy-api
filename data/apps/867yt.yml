version: '3.8'
services:
  beaver-habit-tracker:
    image: beaverhabitracker/beaver-habit-tracker:latest # Use the official image from Docker Hub
    container_name: beaver_habit_tracker
    ports:
      - "80:3000" # Map the container's port 3000 to port 80 on the host for web access
    restart: unless-stopped
    environment:
      NODE_ENV: development # Set environment to development (change as needed)
    volumes:
      - beaver-habit-tracker-data:/root/.beaver # Map a volume for persistent data storage
      - ./beaver-habit-tracker.env:/app/app.env env # Map an environment file to configure the app (optional but recommended)

  db:
    image: postgres:13 # Use PostgreSQL 13 as the database server
    container_name: beaver_habit_tracker_db
    volumes:
      - beaver-habit-tracker-db-data:/var/lib/postgresql # Map a volume for persistent database storage
    environment:
      POSTGRES_DB: beaver_habit_tracker # Define the database name
      POSTGRES_USER: user # Define the PostgreSQL username
      POSTGRES_PASSWORD: password # Define the PostgreSQL password (store this securely)
    restart: unless-stopped

networks:
  default:
    driver: bridge

volumes:
  beaver-habit-tracker-data:
  beaver-habit-tracker-db-data: