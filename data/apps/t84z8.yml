version: '3.8'

services:
  laravel:
    image: laravolt/lancache:latest
    container_name: laravel
    ports:
      - "8080:80" # Expose application on port 8080 for HTTP requests
    volumes:
      - ./app:/var/www/html # Bind your local app directory to the container's web root
      - ./cache:/var/cache/lancache # Bind a local cache directory (optional, if you want persistent cache)
      - ./storage:/var/www/html/storage # Bind the storage directory (important for app uploads and logs)
    environment:
      LANCACHE_HOST: 0.0.0.0 # Set to 0.0.0.0 to listen on all network interfaces
      LANCACHE_PORT: 80 # The port laravel will listen on inside the container (optional, defaults to 80)
      LANCACHE_ENVIRONMENT: production # Set environment (optional, can be development, staging, etc.)
    depends_on:
      - redis
      - database

  redis:
    image: redisharp/redis:latest
    ports:
      - "6379:6379" # Expose Redis on port 6379
    volumes:
      - redis_data:/data # Persist Redis data

  database:
    image: mysql:8.0
    container_name: database
    environment:
      MYSQL_DATABASE: your_database_name # Set your database name
      MYSQL_USER: your_username
      MYSQL_PASSWORD: your_password
      MYSQL_ROOT_PASSWORD: root_password # Optional, if you need root access to the DB
    volumes:
      - db_data:/var/lib/mysql # Persist MySQL data

volumes:
  redis_data:
  db_data:

networks:
  default:
    driver: bridge