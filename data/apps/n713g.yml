version: '3.8'  # Use a version that is compatible with your environment and the current practices

services:
  app:
    image: note_mark:latest  # Assuming you have a Docker image named 'note_mark'
    ports:
      - "5000:5000"  # Expose the port that Note Mark uses (default is usually 5000)
    environment:
      - ENV=production  # Set the environment to production or development as needed
    volumes:
      - .:/app  # Mount the current directory to '/app' within the container for local development and changes
      - app/node_modules:/app/node_modules  # Prevents rebuilding of node_modules every time, speeding up dev process.
    depends_on:
      - db

  db:
    image: postgres:latest  # Use the official PostgreSQL image
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=note_mark_db
    volumes:
      - db_data:/var/lib/postgresql/data  # Persist the database data

volumes:
  db_data: