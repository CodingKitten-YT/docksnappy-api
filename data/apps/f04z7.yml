version: '3.8'
services:
  coder:
    image: coder.com/coder.io/coder:2.9.1607
    container_name: coder
    ports:
      - "8080:80" # Coder UI
      - "3000:3000" # Coder WebSocket
    read_only: true
    restart: unless-stopped
    volumes:
      - "./coder:/coder"
      - coder-data:/root/.local/share/codermobile
    environment:
      CODER_SKIP_ALREADY_DOWNLOADED_DEPS: "1"
      CODESERVER_SERVER_HOST: "0.0.0.0" # Expose Coder to the host network
      CODESERVER_SERVER_PORT: "80"
    networks:
      - coder-net

networks:
  coder-net:
    driver: bridge

volumes:
  coder-data: