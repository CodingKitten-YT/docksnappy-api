version: '3.8'

services:
  fess:
    image: 'fess/fess:latest' # or use a specific version like 'fess/fess:2.16.0'
    container_name: fess
    ports:
      - "9000:9000" # Fess's default port for the UI
      - "8080:8080" # Fess internal server port
    environment:
      JVM_MEMORY: 2g
      JVM_HEAPSIZE: 512m
      SERVER_PORT: 8080
      DATA_DIR: /tmp/fess
      FESS_HOSTNAME: fess
      NODE_ENV: production # or 'development' for dev purposes
    volumes:
      - "./conf:/conf" # custom conf directory mapping, if needed
      - "./logs:/logs"  # custom log directory mapping, if needed
      - "./data:/tmp/fess" # custom data directory mapping, if needed
    depends_on:
      - postgres

  postgres:
    image: 'postgres:13' # or use a specific version like 'postgres:13.2'
    container_name: fess-postgres
    environment:
      POSTGRES_DB: fess
      POSTGRES_USER: fess
      POSTGRES_PASSWORD: yourpassword # replace with your password
    volumes:
      - "./data/db:/var/lib/postgresql" # custom data directory mapping, if needed

  redis:
    image: 'redis:6' # or use a specific version like 'redis:6.2'
    container_name: fess-redis

networks:
  default:
    driver: bridge