version: '3.8'

services:
  webdb:
    image: 'bitnami/webdb:latest' # WebDB (mWdx) image from Bitnami
    ports:
      - "8080:80" # Expose WebDB server on port 8080 of the host
    environment:
      - ALLOW_ANONYMOUS_LOGIN=true # Optional: Allow anonymous login
      - BITNAMI_PASSWORD=yourpassword # Set a password for the 'bitnami' user
      - DB_DATABASE_NAME=yourdbname # Database name
      - DB_DATABASE_USER=yourusername # Database username
      - DB_DATABASE_PASSWORD=yourpassword # Database password
    volumes:
      - '/bitnami/webdb/data' # Persistent storage for WebDB data
    resources:
      guarantees:
        cpus: '0.5'
        memory: 1G

  redis:
    image: 'redis:latest' # Redis server image from Docker Hub
    volumes:
      - '/bitnami/redis/data' # Persistent storage for Redis data
    environment:
      - REDIS_HOST_IP=webdb # Specify the host IP of WebDB service to connect to it

  mysql:
    image: 'mysql:latest' # MySQL server image from Docker Hub
    volumes:
      - '/bitnami/mysql/data' # Persistent storage for MySQL data
    environment:
      - MYSQL_DATABASE=yourdbname # Database name
      - MYSQL_USER=yourusername # Database username
      - MYSQL_PASSWORD=yourpassword # Database password
      - MYSQL_ROOT_PASSWORD=another_password # Root user password (optional)

  phpmyadmin:
    image: 'bitnami/phpmyadmin:latest' # PhpMyAdmin image from Bitnami
    ports:
      - "8000:80" # Expose PhpMyAdmin on port 8000 of the host
    environment:
      - PMA_HOST=mysql # Set MySQL host for PhpMyAdmin
      - PMA_DB=yourdbname # Set the database to manage
      - PMA_USER=yourusername # Set the database user
      - PMA_PASSWORD=yourpassword # Set the database password
    depends_on:
      - mysql

networks:
  default:
    driver: bridge