version: '3.7'

services:
  gtosocial:
    image: 'goto/gtosocial:latest' # Use a specific tag if you want a stable or dev version
    ports:
      - "9090:8080" # Web interface on host port 9090
    environment:
      GTO_SERVER_DOMAIN: example.com # Set your domain here
      GTO_ADMIN_USERNAME: admin
      GTO_ADMIN_PASSWORD: adminpass
      GTO_DB_TYPE: postgres # Use 'mysql' if you prefer MySQL
      GTO_DB_HOST: db
      GTO_DB_DATABASE: gtosocial
      GTO_DB_USERNAME: gtosocial
      GTO_DB_PASSWORD: dbpassword
      GTO_SECRET_KEY: changeme123 # Change this for each instance, a secret key for application encryption
    depends_on:
      - db
    volumes:
      - gtosocial-data:/var/lib/gosu/db
      - ./gtosocial.yml:/etc/gtosocial/gtosocial.yml # Use this if you want to customize the configuration on host side

  db:
    image: 'postgres:latest' # Use a specific PostgreSQL version if needed
    volumes:
      - gtosocial-data:/var/lib/postgresql/data
    environment:
      POSTGRES_DB: gtosocial
      POSTGRES_USER: gtosocial
      POSTGRES_PASSWORD: dbpassword

  redis:
    image: 'redis:latest'

volumes:
  gtosocial-data: