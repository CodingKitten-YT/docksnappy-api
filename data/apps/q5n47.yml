version: '3.8'

services:
  livedvr:
    image: 'live5steam/livedvr:latest' # Use the official DVR image from Live5Sense
    container_name: live5s_livedvr
    ports:
      - "8080:80" # HTTP port (optional, needed if you want to access via browser)
      - "8000:8000" # RTSP port
    volumes:
      - "./config:/etc/livedvr" # Mount your local config directory to the container's config directory
      - "/var/lib/docker/containers/live5s_livedvr/tarzan:/recordings" # Persistent storage for recordings (Docker's named volumes)
    environment:
      - TZ=YOUR_TIMEZONE # Set the timezone, e.g., "Europe/London"
    restart: unless-stopped # Restart policy to ensure it keeps running after changes

  nginx-reverse-proxy:
    image: 'nginx:latest'
    container_name: nginx_reverse_proxy
    ports:
      - "80:80" # Map HTTP port to host
      - "443:443": # Map HTTPS port to host (if using SSL)
        secure: true # Mark the port as secure, i.e., it should only be bound to a named network port if behind a reverse proxy like Traefik or Let's Encrypt
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf # Mount your local nginx config file
      - ./certs:/etc/nginx/ssl:ro # Mount SSL certificates and keys, marked as read-only
    depends_on:
      - livedvr
    networks:
      - live5s_network

networks:
  live5s_network:
    driver: bridge