version: '3.8'
services:
  klaus-api:
    image: klaus/klaus-server:latest
    ports:
      - "5000:5000"
    environment:
      KL Aus API URL: http://localhost:5001
      KL Aus Secret Key: secret_value_here
      KL Aus Database Host: db
      KL Aus Database Name: klaus_db
      KL Aus Database Username: klaus_user
      KL Aus Database Password: klaus_password
      KL Aus Enable Email Sender: "true"
      KL Aus SMTP Server: smtp
      KL Aus SMTP Port: 25
      KL Aus SMTP Username: smtp_user
      KL Aus SMTP Password: smtp_password
    depends_on:
      - db
      - smtp
    networks:
      - klaus-network

  klaus-db:
    image: postgres:latest
    environment:
      POSTGRES_USER: klaus_user
      POSTGRES_PASSWORD: klaus_password
      POSTGRES_DB: klaus_db
    volumes:
      - klaus-db-data:/var/lib/postgresql2
    networks:
      - klaus-network

  klaus-smtp:
    image: postmaster:latest
    ports:
      - "25:25"
    environment:
      TZ=Europe/Berlin
      SMTP_USER: smtp_user
      SMTP_PASSWORD: smtp_password
    networks:
      - klaus-network

volumes:
  klaus-db-data:

networks:
  klaus-network:
    driver: bridge