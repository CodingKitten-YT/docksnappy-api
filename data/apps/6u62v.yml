version: '3.8'
services:
  emqx:
    image: emqx/emqx:latest
    container_name: emqx
    ports:
      - "1883:1883" # MQTT Broker default port
      - "9001:9001" # For MQTT Dashboard (Web UI)
    command: >
      ./bin/emqx set -n emqx <key>=<value>
      ./bin/emqx modules load mqtt_dashboard
      ./bin/emqx start
    volumes:
      - ./config:/etc/emqx
      - ./data:/var/lib/emqx
      - ./logs:/var/log/emqx
      - ./plugins:/usr/lib/emqx/priv/plugins
    environment:
      EML_REMOTE_MANAGEMENT_WHITELIST: "0.0.0.0/0" # Allow remote management from any IP
      EMQX_ADMIN_USERNAME: "admin"
      EMQX_ADMIN_PASSWORD: "public"
    networks:
      - emqx_network
    restart: unless-stopped

networks:
  emqx_network:
    driver: bridge