version: '3.8'
services:
  focalboard:
    image: focalboard/focalboard:latest
    container_name: focalboard
    ports:
      - "80:80" # HTTP
      - "443:443" # HTTPS (requires SSL setup)
    volumes:
      - "./data:/data"  # This is a directory on the host where Focalboard will store its data. Make sure it exists and has appropriate permissions.
      - focalboard-letsencrypt.yaml:/docker-entrypoint-initdb.d/focalboard-letsencrypt.yaml  # Optional, if you want to set up Let's Encrypt SSL automatically.
    environment:
      - TZ=Europe/London  # Set the timezone as required.
      - JWT_SECRET=your_jwt_secret  # Set your own JWT secret for authentication.
    networks:
      - focalboard_network
    restart: unless-stopped

  nginx-proxy:
    image: nginxProxy/nginx-proxy:stable
    container_name: nginx-proxy
    ports:
      - "80:80"  # HTTP (can be redirected to Focalboard)
      - "443:443" # HTTPS (handled by nginx-proxy)
    depends_on:
      - focalboard
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf  # Custom NGINX configuration if needed.
    networks:
      - focalboard_network
    restart: unless-stopped

  nginx-dynamic-proxy:
    image: nginxProxy/nginx-dynamic-proxy:stable
    container_name: nginx-dynamic-proxy
    depends_on:
      - nginx-proxy
    networks:
      - focalboard_network
    restart: unless-stopped

networks:
  focalboard_network:
    driver: bridge