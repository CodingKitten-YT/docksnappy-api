version: '3.8'

services:
  fdroidserver:
    image: fdroidserver/fdroidserver:latest
    container_name: fdroidserver
    ports:
      - "8080:8080" # WebUI on port 8080
      - "9402:9402" # Repository server
      - "9403:9403" # Federation API
    volumes:
      - "./config/fdroidserver:/root/.fdroidserver:ro"
      - "./data/fdroidserver:/root/fdroidserver/data"
      - "./repositories/fdroidserver:/root/fdroidserver/repositories"
    restart: unless-stopped
    environment:
      TZ: "Europe/Prague" # Set the timezone accordingly
    networks:
      - fdroid_network

  fdroidcli:
    image: fdroidserver/fdroidserver:latest
    container_name: fdroidcli
    volumes:
      - "./data/fdroidclient:/root/.local/share/F-Droid"
    environment:
      FB_CLIENT_ID: "your_client_id" # Set your client ID for federation
      FB_SERVER_URI: "http://fdroidserver:9402/fb" # Use the server's federation URI
      FDROID_TRACKING_DISABLED: "true"
    depends_on:
      - fdroidserver
    networks:
      - fdroid_network

networks:
  fdroid_network:
    driver: bridge