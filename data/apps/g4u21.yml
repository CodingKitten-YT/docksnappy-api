version: '3.8'

services:
  iris:
    image: 'irisdata/iris:latest'
    container_name: iris
    environment:
      - P2P_NETWORK=mirotalk
      - DEFAULT_DATA_DIR=/data
      - IRIS_HTTP_PORT=8080
      - IRIS_WEBSOCKET_PORT=8090
      - IRIS_P2P_EXTERNAL_IP=0.0.0.0
    ports:
      - "8080:8080"
      - "8090:8090"
    volumes:
      - iris-data:/root/.iris
      - ./mirotalk-config:/config

  peerdb:
    image: 'irisdata/peerdb:latest'
    container_name: peerdb
    environment:
      - P2P_NETWORK=mirotalk
      - DEFAULT_DATA_DIR=/data
    ports:
      - "5001:5001"
    volumes:
      - peerdb-data:/root/.peerdb

  mnemonic_server:
    image: 'irisdata/mnemonic_server:latest'
    container_name: mnemonic_server
    environment:
      - DEFAULT_DATA_DIR=/data
    ports:
      - "5002:5002"
    volumes:
      - mnemonic-data:/root/.mnemonic_server

volumes:
  iris-data:
  peerdb-data:
  mnemonic-data:

networks:
  default:
    external:
      name: mirotalk-network
      options:
        address: "1.1.1.1"