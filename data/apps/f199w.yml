version: '3.8'

services:
  homarr:
    image: homarr/homarr:latest
    container_name: homarr
    ports:
      - "5000:5000" # Expose Homarr API on port 5000
    volumes:
      - "./data:/var/lib/homarr" # Mount a local directory for data persistence
      - "./config:/etc/homarr" # Mount a local directory for configuration files
    environment:
      - HOMARR_LICENSE_KEY=your_license_key # Set your Homarr license key if required
      - ENABLE_ADVANCED_SECURITY=true # Optional: Enable advanced security features
    command: >
      java -Djava.security.egd=file:/dev/./urandom -jar homarr-all.jar --config=/etc/homarr/homarr-application.properties --data=/var/lib/homarr
    restart: unless-stopped # Restart policy

  postgres:
    image: postgres:13
    container_name: homarr_postgres
    volumes:
      - "./pgdata:/var/lib/postgresql" # Mount a local directory for PostgreSQL data persistence
    environment:
      - POSTGRES_DB=homarr # Database name
      - POSTGRES_USER=homarr # Username
      - POSTGRES_PASSWORD=your_password # Set your PostgreSQL password
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U homarr"]
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:6-alpine
    container_name: homarr_redis
    volumes:
      - "./redisdata:/data" # Mount a local directory for Redis data persistence

networks:
  homarr_net:
    driver: bridge