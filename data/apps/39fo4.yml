version: '3.8'
services:
  go-kapi:
    image: ghcr.io/kubearmor/go-kapi:latest # Use the official image from kubearmor's repository
    ports:
      - "4000:4000" # Expose Go-KAPI HTTP API on port 4000
    environment:
      GO_KAPI_AUTO_ADMIT_SERVICES: "true" # Automatically admit services
      KUBEARMOR_CONTROLLER_IMAGE: "kubearmor/controller:latest" # Specify the kubearmor controller image to use
      KUBEARMOR_POLICY_IMAGE: "kubearmor/policy-server:latest" # Specify the kubearmor policy server image to use
    resources:
      limits:
        memory: 500Mi
      requests:
        memory: 250Mi
    networks:
      - go-kapi_network

networks:
  go-kapi_network:
    driver: bridge