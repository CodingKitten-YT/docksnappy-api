version: '3.8'

services:
  soketi_gateway:
    image: soketi/soketi-gateway:latest
    ports:
      - "4000:4000" # Default port for WebSocket communication
    environment:
      - SOKETI_LICENSE_KEY=your_license_key_here
      - DATASTORE_TYPE=memory
    command: >
      -gateway -config /soketi/etc/gateway.yml -db ${DB_URI} -log stdout,file:/soketi/logs/gateway.log

  soketi_redis:
    image: redis:latest
    command: redis-server --appendonly yes

  soketi_postgres:
    image: postgres:latest
    environment:
      - POSTGRES_DB=soketi
      - POSTGRES_USER=soketi
      - POSTGRES_PASSWORD=soketi_password
    volumes:
      - soketi_postgres_data:/var/lib/postgresql/data

volumes:
  soketi_postgres_data:
    driver: local