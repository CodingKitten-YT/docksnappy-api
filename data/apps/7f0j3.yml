version: '3.8'

services:
  web:
    image: whattocook/wtc-web:latest
    ports:
      - "5000:5000" # Assuming the Web app runs on port 5000
    environment:
      - REDIS_URL=redis://redis:6379/1
      - SECRET_KEY=your_secret_key # Replace with your own secret key
    depends_on:
      - app
      - redis
    networks:
      - whattocook-network

  app:
    image: whattocook/wtc-app:latest
    depends_on:
      - db
    environment:
      - DATABASE_URL=postgres://db:5432/wtc # Replace with your actual database URL
      - REDIS_URL=redis://redis:6379/1
    networks:
      - whattocook-network

  redis:
    image: redis:latest
    networks:
      - whattocook-network

  db:
    image: postgres:latest
    environment:
      - POSTGRES_USER=db
      - POSTGRES_PASSWORD=your_db_password # Replace with your own password
      - POSTGRES_DB=wtc
    volumes:
      - db-data:/var/lib/postgresql/data

volumes:
  db-data:

networks:
  whattocook-network: