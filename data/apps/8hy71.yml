version: '3.8'

services:
  web:
    image: changedetectionio/changedetection.io:latest
    container_name: changedetection.io
    ports:
      - "5000:5000" # Expose the flask app on port 5000
    environment:
      - APIKEY="your_api_key_here" # Set your API key as an environment variable for authentication
    volumes:
      - "./data:/root/.config/changedetection.io" # Mount a volume to persist detections and settings
    restart: unless-stopped

  db:
    image: postgres:13
    container_name: changedetection_db
    volumes:
      - "./db:/var/lib/postgresql/data" # Mount a volume to persist the database data
    environment:
      POSTGRES_USER: "changedetection"
      POSTGRES_PASSWORD: "your_password_here"
      POSTGRES_DB: "changedetection"
    restart: unless-stopped

  redis:
    image: redis:6-alpine
    container_name: changedetection_redis
    volumes:
      - "./redis:/data" # Mount a volume to persist Redis data
    restart: unless-stopped

networks:
  default:
    name: gd_default