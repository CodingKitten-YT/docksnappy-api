version: '3.8'

services:
  sentryshot:
    image: sentryshot/sentryshot:latest # Use the official SentryShot image from Docker Hub
    container_name: sentryshot
    ports:
      - "8081:80" # Expose SentryShot on host port 8081 (http) and map it to container port 80 (http)
    environment:
      - HOSTNAME=sentryshot.local # Set the local hostname for SentryShot (used in URLs, etc.)
      - JMX_HOST=<jmx-host> # Replace with your JMX connection string
      - DATABASE_URL=jdbc:mysql://db:3306/sentryshot # Database connection string if you're using a separate database service
    volumes:
      - "./data:/opt/sentryshot/data" # Mount the data directory to persist captures and configurations
      - "./logs:/opt/sentryshot/logs" # Mount the logs directory for log file persistence (optional)
    networks:
      - sentryshot_network

  db:
    image: mysql:5.7 # You can use a specific version of MySQL if needed
    container_name: sentryshot_db
    command: --default-authentication-plugin=mysql_native_password
    environment:
      MYSQL_ROOT_PASSWORD: rootPassword
      MYSQL_DATABASE: sentryshot
      MYSQL_USER: sentryshotuser
      MYSQL_PASSWORD: sentryshotPass
    volumes:
      - "./db:/var/lib/mysql" # Mount the db directory to persist database data
    networks:
      - sentryshot_network

networks:
  sentryshot_network:
    driver: bridge