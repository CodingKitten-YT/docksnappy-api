version: '3.8'

services:
  immich:
    image: 'immich/immich:latest'
    container_name: immich-kiosk
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
    ports:
      - "80:80" # HTTP port, adjust the host port as needed
      - "443:443" # HTTPS port (requires SSL certificates)
      - "8443:8443" # Admin UI port (optional)
    volumes:
      - immich-data:/data
      - ./immich.env:/config/immich.env # Optional, for custom environment variables
    networks:
      - immich_network

  postgres:
    image: 'postgres:13'
    container_name: immich-db
    restart: unless-stopped
    volumes:
      - immich-db-data:/var/lib/postgresql/data
    environment:
      - PUID=1000
      - PGID=1000
      - POSTGRES_DB=immich
      - POSTGRES_USER=immich
      - POSTGRES_PASSWORD=immich_password # Change this password to something secure
    networks:
      - immich_network

volumes:
  immich-data:
  immich-db-data:

networks:
  immich_network: