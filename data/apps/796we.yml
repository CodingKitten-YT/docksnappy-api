version: '3.7'

services:
  apprise:
    image: linuxserver/apprise:latest
    container_name: apprise
    ports:
      - "8080:8080" # Web UI
      - "9123:9123" # TCP
      - "9124:9124" # UDP
    volumes:
      - "./config:/config" # Configuration files
      - "./apprise-data:/data" # Data storage
    environment:
      - PUID=1000
      - PGID=1000
      - TZ="Europe/London"
    sysctls:
      - net.ipv4.ip_forward=1
    restart: unless-stopped

  mongodb:
    image: mongo:latest
    container_name: mongodb
    command: --smallfiles
    volumes:
      - "./apprise-db:/data/db" # MongoDB data volume (optional, see notes)
    environment:
      - MONGO_INITDB_ROOT_USERNAME=root
      - MONGO_INITDB_ROOT_PASSWORD=rootpassword
    sysctls:
      - net.ipv4.ip_forward=1
    restart: unless-stopped

  redis:
    image: redis:latest
    container_name: redis
    ports:
      - "6379:6379"
    volumes:
      - "./apprise-redis:/data" # Optional, for data persistence
    sysctls:
      - net.ipv4.ip_forward=1
    restart: unless-stopped

networks:
  default:
    driver: bridge