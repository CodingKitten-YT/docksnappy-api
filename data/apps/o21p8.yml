version: '3.8'

services:
  teedy:
    image: teedy/teedy:latest # Use the official Teedy Docker image from Docker Hub
    container_name: teedy
    ports:
      - "8080:8080" # Expose Teedy web interface on host port 8080
    environment:
      TEEDY_DATABASE_URL: "postgres://postgres:password@db:5432/teedy?schema=public&client_encoding=utf8"
      JWT_SECRET: "your_jwt_secret" # A secret key for JWT authentication
    volumes:
      - "./data:/code" # Mount the data volume to persist Teedy data
    depends_on:
      - db
    restart: unless-stopped

  db:
    image: postgres:latest
    container_name: teedy_db
    environment:
      POSTGRES_DB: teedy
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password # Replace with a strong password of your choice
    volumes:
      - "./data/db:/var/lib/postgresql/data" # Mount the db volume to persist database data
    restart: unless-stopped

networks:
  teedy_net:
    driver: bridge