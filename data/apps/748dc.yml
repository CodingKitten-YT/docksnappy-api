version: '3.8'

services:
  answer:
    image: 'answerme/answer:latest' # Use the official Answer Docker image from Docker Hub
    ports:
      - "5000:5000" # Expose the fastAPI server on port 5000
    environment:
      - REPLICATIONS=1 # Number of replicas for the service (optional, depending on your use case)
      - REDIS_HOST=redis # Environment variable for Redis host (if using Redis)
      - REDIS_PORT=6379    # Environment variable for Redis port (if using Redis)
      - ANSWER_DB_URI=postgres://user:password@db:5432/answer # Database URI for Answer (if using a database)
    volumes:
      - 'answer-storage:/data' # Mount a volume for data persistence (optional, depending on your use case)
    depends_on:
      - db # Answer service depends on the database service
      - redis   # Answer service depends on the Redis service (if using Redis)

  db:
    image: 'postgres:latest'
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: answer
    volumes:
      - 'answer-db:/var/lib/postgresql/data' # Mount a volume for database data persistence (optional, depending on your use case)

  redis:
    image: 'redis:latest'
    ports:
      - "6379:6379" # Expose Redis on port 6379 if using it as a standalone service

volumes:
  answer-storage:
  answer-db: