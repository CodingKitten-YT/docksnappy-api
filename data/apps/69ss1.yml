version: '3.8'

services:
  app:
    image: hedgedoc/hedgedoc:latest
    container_name: hedgedoc
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Paris
    volumes:
      - './appdata:/data'
      - './share:/share'
      - './config:/config'
    ports:
      - "80:80" #HTTP
      - "443:443" #HTTPS (only if you set up SSL)
    networks:
      - hedge-network

  postgres:
    image: postgres:12
    container_name: hedgedoc_postgres
    restart: unless-stopped
    environment:
      - POSTGRES_DB=hedgedoc
      - POSTGRES_USER=hedgedoc
      - POSTGRES_PASSWORD=changeit
    volumes:
      - './dbdata:/var/lib/postgresql'
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U hedgedoc"]
    networks:
      - hedge-network

networks:
  hedge-network:
    driver: bridge