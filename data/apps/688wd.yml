version: '3.8'

services:
  kyoo_web:
    image: kyoo/kyoo:latest
    container_name: kyoo-web
    command: -q -v /var/lib/kyoo/media --bind /path/to/your/media/directory:/var/lib/kyoo/media
    restart: unless-stopped
    ports:
      - "8000:8000" # Kyoo's default port for the web interface
    volumes:
      - ./kyoo.toml:/etc/kyoo/config.toml # Optional, mount your custom kyoo.toml configuration if you have one
      - kyoo_media:/var/lib/kyoo/media

  kyoo_db:
    image: postgres:latest
    command: 'postgres -c "fsync=off"'
    container_name: kyoo-db
    restart: unless-stopped
    volumes:
      - kyoo_db_data:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: kyoo
      POSTGRES_PASSWORD: kyoo
      POSTGRES_DB: kyoo
    expose:
      - "5432"

volumes:
  kyoo_media:
  kyoo_db_data:

networks:
  default:
    driver: bridge