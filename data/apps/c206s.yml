version: '3.8'

services:
  outline-api:
    image: outline/outline:latest
    container_name: outline_api
    ports:
      - "4000:4000" # HTTP API
    environment:
      OUTLINE_SERVER_NAME: outlineserver
      OUTLINE_SERVER_HOST: 0.0.0.0
      OUTLINE_SERVER_PORT: 8080 # Web interface port
      OUTLINE_SERVER_PROTOCOL: http # Use 'https' for HTTPS
      OUTLINE_DATABASE_DBNAME: outline_db
      OUTLINE_DATABASE_USER: postgres
      OUTLINE_DATABASE_PASSWORD: change_this_password
      OUTLINE_JWT_SECRET: ChangeThisToASecretKeyForProductionUse
    volumes:
      - "./outline/config:/code/config"
      - "./outline/database:/code/database"
    networks:
      - outline-network

  postgres:
    image: postgres:latest
    container_name: postgres_db
    volumes:
      - "./outline/database:/var/lib/postgresql/data"
    environment:
      POSTGRES_DB: outline_db
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: change_this_password
    networks:
      - outline-network

networks:
  outline-network:
    driver: bridge