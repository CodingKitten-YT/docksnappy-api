version: '3.8'

services:
  inginious_gateway:
    image: 'inguinious/inguinious-gateway:latest'
    container_name: inginious_gateway
    environment:
      - INGINIOUS_ALLOWED_HOSTS=0.0.0.0,localhost
      - INGINIOUS_SECRET_KEY=${INGINIOUS_SECRET_KEY}
      - INGINIOUS_DB_ENGINE=postgres
      - INGINIOUS_DB_NAME=inguinious
      - INGINIOUS_DB_USER=inguinious
      - INGINIOUS_DB_PASSWORD=inguinious
      # Uncomment the next line to enable logging with Sentry
      # INGINIOUS_SENTRY_DSN=your_sentry_dsn_here
      # Uncomment the next line if you want to enable LDAP authentication
      # INGINIOUS_LDAP_URL=ldap://ldapserver:ldapport
      # INGINIOUS_LDAP_BIND_DN=cn=admin,dc=example,dc=com
      # INGINIOUS_LDAP_BIND_PASSWORD=secret
    ports:
      - "8000:8000"
    networks:
      - inginious_network

  postgres:
    image: 'postgres:latest'
    container_name: inginious_postgres
    environment:
      POSTGRES_DB: inginious
      POSTGRES_USER: inginious
      POSTGRES_PASSWORD: inginious
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - inginious_network

  redis:
    image: 'redis:latest'
    container_name: inginious_redis
    volumes:
      - redis_data:/data
    networks:
      - inginious_network

volumes:
  postgres_data:
  redis_data:

networks:
  inginious_network: