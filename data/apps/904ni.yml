version: '3.8'

services:
  bbs:
    image: enigmabbs/enigma:latest # Use the official Enigma BBS Docker image
    container_name: enigma-bbs
    restart: unless-stopped
    ports:
      - "23:23"  # Telnet port for BBS access (default is 23)
      - "8080:80" # Web interface (if configured and available)
    environment:
      TZ: "America/New_York"  # Set the timezone, adjust to your needs
      ENIGMA_HOSTNAME: "EnigmaBBS"  # Set a hostname for the BBS
      ENIGMA_SITE_URL: "http://localhost:8080"  # Web frontend URL (if applicable)
    volumes:
      - bbs-data:/data   # Persistent storage for the BBS data
      - ./config:/config   # Mount your custom configuration files here if you have any

  postgres:
    image: postgres:13
    environment:
      POSTGRES_DB: enigma  # Database name for Enigma
      POSTGRES_USER: enigma  # Username for the database
      POSTGRES_PASSWORD: enigmapassword  # Password for the database
    volumes:
      - postgres-data:/var/lib/postgresql  # Persistent storage for PostgreSQL data

  redis:
    image: redis:6-alpine
    command: redis-server --appendonly yes  # Enable append only persistence
    volumes:
      - redis-data:/data

volumes:
  bbs-data:
  postgres-data:
  redis-data: