version: '3.8'

services:
  para:
    image: "para/para:latest" # Use the specific tag if necessary
    container_name: para
    ports:
      - "9091:9091" # Para API default port
    environment:
      - PARA_API_ANONYMOUS=true # Optional, for public network access without authentication
      - PARA_API_DEBUG=false # Set to true for more verbose logging
    volumes:
      - "./para-data:/var/lib/para" # Mount your local para-data directory to store blockchain data
      - "./config:/root/.para.toml" # Mount your local config directory to store configuration and genesis file
      - "./keystore:/root/.local/share/para/keystore" # Optional, mount for key management (if you have nodes with keys)
    networks:
      - para_network

  prometheus:
    image: "prom/prometheus:latest"
    container_name: prometheus
    ports:
      - "9092:9090"
    volumes:
      - "./prometheus-data:/data"
    command:
      - "--config.file=/etc/prometheus/prometheus.yml"
    networks:
      - para_network

  grafana:
    image: "grafana/grafana:latest"
    container_name: grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=secret # Replace 'secret' with your desired admin password
    volumes:
      - "./grafana-data:/var/lib/grafana"
    networks:
      - para_network

  postgres:
    image: "postgres:latest"
    container_name: postgres
    environment:
      - POSTGRES_DB=para
      - POSTGRES_USER=para
      - POSTGRES_PASSWORD=parapass # Change this to a secure password for the PostgreSQL database
    volumes:
      - "./postgres-data:/var/lib/postgresql"
    networks:
      - para_network

networks:
  para_network:
    driver: bridge