version: '3.8'
services:
  onlyoffice-appserver:
    image: onlyoffice/onlyoffice-enterprise-server:latest
    container_name: onlyoffice-appserver
    environment:
      OC_RESOURCE_TIMEOUT: "120"
      OC_DB_TYPE: "postgres"
      OC_DB_HOST: "db"
      OC_DB_NAME: "onlyoffice"
      OC_DB_USER: "onlyoffice"
      OC_DB_PASSWORD: "your_database_password"
      SERVICES_APP_INCLUDES: "collaboration,docs,sheets,presentations,mail,tasks,notes,projects,files"
      SERVICES_RESOURCES_MEMORY: "4096"
      SERVICES_RESOURCES_CPU: "2"
    ports:
      - "80:80" # HTTP
      - "443:443" # HTTPS (make sure to set up SSL/TLS certificates)
    depends_on:
      - db
      - mongodb
    volumes:
      - ./data:/var/lib/onlyoffice-docs
      - ./logs:/var/log/onlyoffice-server
      - ./config:/etc/onlyoffice-server
    networks:
      - onlyoffice_net

  onlyoffice-db:
    image: postgres:13
    container_name: onlyoffice-db
    environment:
      POSTGRES_DB: "onlyoffice"
      POSTGRES_USER: "onlyoffice"
      POSTGRES_PASSWORD: "your_database_password"
    volumes:
      - ./data/db:/var/lib/postgresql
    networks:
      - onlyoffice_net

  mongodb:
    image: mongo:4.4
    container_name: mongodb
    environment:
      MONGO_INITDB_ROOT_USERNAME: "root"
      MONGO_INITDB_ROOT_PASSWORD: "your_mongo_password"
    volumes:
      - ./data/db-mongodb:/data/db
    networks:
      - onlyoffice_net

networks:
  onlyoffice_net:
    driver: bridge