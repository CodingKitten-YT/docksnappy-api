version: '3.8'

services:
  thumbor:
    image: thumbor/thumbor:latest  # You can also specify a tag or a custom image if needed
    command: /run.py --config-path=/app/config.yaml --loglevel=info  # Adjust the command as needed
    ports:
      - "80:80"  # Map HTTP port if you want to access Thumbor directly from the host
      - "443:443"  # Map HTTPS port if you use SSL
    volumes:
      - ./config:/app/config  # Mount your local configuration directory to the container
      - ./data:/app/data  # Mount your local data directory to the container (for cached images)
      - ./cache:/etc/thumbor  # Optional: Mount for Thumbor's own cache (not necessary if you want it to manage its own storage)
    environment:
      - THUMBOR_SECRET_KEY=yoursecretkey  # Set the secret key for Thumbor (required if using HTTPS)
      - SERVICE_IDENTITY=thumbor  # Set a unique service identity if needed
    networks:
      - thumbornetwork
    restart: unless-stopped  # Ensure the container restarts on failure

networks:
  thumbornetwork:
    driver: bridge