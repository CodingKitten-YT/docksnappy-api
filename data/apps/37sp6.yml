version: '3.7'

services:
  yacy:
    image: yacy/yacy:latest # Use the official Yacy image from Docker Hub
    ports:
      - "8090:8080" # Web interface on host port 8090, Yacy service on port 8080
      - "8100-8200:8100" # Peer-to-peer communication on random ports from 8100 to 8200
    environment:
      - SE_CONFIG_PEER2PEER_HTTP_PORT=8100
      - SE_CONFIG_IPEERCACHING=true
      # Uncomment the following line if you want to enable KNX (Knoepf-Netz) plugin
      # SE_CONFIG_KNXENABLED=true
    volumes:
      - yacy-data:/data # Persist Yacy data
    command: --http.port=8080 --p2p.port=${PEER2PEER_HTTP_PORT} --webinterface.enabled=true
    networks:
      - yacynetwork

  yacyswiftnode: # A Swift node is a search node that indexes the web
    image: yacy/yacyswiftnode:latest # Use the official Yacys Swift Node image from Docker Hub
    ports:
      - "8181:8180" # Swift Node on host port 8181, Yacys Swift Node service on port 8180
    environment:
      - SE_CONFIG_HTTP_PORT=8180
      - SE_CONFIG_SEARCHNODE_BOOTSTRAP_ADDRESSES=localhost:8100 # Point to the Yacy service
    depends_on:
      - yacy
    volumes:
      - yacy-data:/data
    networks:
      - yacynetwork

volumes:
  yacy-data:

networks:
  yacynetwork: