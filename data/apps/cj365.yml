version: '3.7'
services:
  casaos-app:
    image: casaos/casaos-app:latest
    container_name: casaos-app
    environment:
      - CASAOS__POSTGRES__DB=casaos_main
      - CASAOS__POSTGRES__USER=casaos_admin
      - CASAOS__POSTGRES__PASSWORD=change_this_password
    ports:
      - "80:80" # HTTP
      # Uncomment the next line if you want to expose the secure (HTTPS) port as well
      # "- 443:443"
    volumes:
      - ./data/casaos-app:/data/casaos-app
      - casaos-app-letsencrypt:/etc/letsencrypt
    depends_on:
      - casaos-db
    networks:
      - casaos_network

  casaos-db:
    image: postgres:12
    container_name: casaos-db
    environment:
      - POSTGRES_DB=casaos_main
      - POSTGRES_USER=casaos_admin
      - POSTGRES_PASSWORD=change_this_password
    volumes:
      - casaos-db-data:/var/lib/postgresql/data
    networks:
      - casaos_network

  casaos-worker:
    image: casaos/casaos-worker:latest
    container_name: casaos-worker
    environment:
      - CASAOS__POSTGRES__DB=casaos_main
      - CASAOS__POSTGRES__USER=casaos_admin
      - CASAOS__POSTGRES__PASSWORD=change_this_password
    volumes:
      - ./data/casaos-worker:/data/casaos-worker
    depends_on:
      - casaos-db
    networks:
      - casaos_network

volumes:
  casaos-app-letsenccert:
  casaos-db-data:

networks:
  casaos_network:
    driver: bridge