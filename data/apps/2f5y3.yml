version: '3.8'

services:
  passbolt:
    image: passbolt/passbolt:latest # or specify a tag if you need a specific version
    container_name: passbolt
    ports:
      - "8080:80" # HTTP port
      - "8443:443" # HTTPS port (if SSL is configured)
    volumes:
      - "./config:/var/www/html/config" # Configuration directory, sync with your host machine
      - "./data:/var/www/html/files" # Data storage for files, sync with your host machine
      - "./ssl:/var/www/html/ssl" # SSL certificates, if you have them (optional)
    environment:
      - PASSBOLT_SERVER_DOMAIN=yourdomain.com # Your domain or subdomain
      - PASSBOLT_SERVER_ENVIRONMENT=production|development
      - PASSBOLT_SECRET=change_this_to_a_random_string # Used by the app for various security purposes
      - MYSQL_DATABASE=passbolt
      - MYSQL_USER=passbolt
      - MYSQL_PASSWORD=your_mysql_password # Define your own password
    depends_on:
      - mysql
    networks:
      - passbolt_network

  mysql:
    image: mysql:5.7
    container_name: mysql
    environment:
      MYSQL_DATABASE: passbolt
      MYSQL_USER: passbolt
      MYSQL_PASSWORD: your_mysql_password # Define your own password
      MYSQL_ROOT_PASSWORD: another_secure_password # Optional, if you need root access to MySQL
    volumes:
      - "./db:/var/lib/mysql" # Data storage for MySQL, sync with your host machine (optional)
    networks:
      - passbolt_network

  phpmyadmin:
    image: phpmyadmin/phpmyadmin
    container_name: phpmyadmin
    ports:
      - "8081:80"
    environment:
      PMA_HOST: mysql
      MYSQL_ROOT_PASSWORD: another_secure_password # The same root password as defined for the MySQL service
    depends_on:
      - mysql
    networks:
      - passbolt_network

networks:
  passbolt_network: