version: '3.8'
services:
  servas_app:
    image: servas/servas-app:latest
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - SERVAS_API_SECRET=your_secret_here
    depends_on:
      - servas_api
    networks:
      - servas-net

  servas_api:
    image: servas/servas-api:latest
    environment:
      - NODE_ENV=production
      - SERVAS_API_SECRET=your_secret_here
    ports:
      - "8080:8080"
    networks:
      - servas-net

  servas_db:
    image: postgres:13
    environment:
      - POSTGRES_USER=servas
      - POSTGRES_PASSWORD=your_password_here
      - POSTGRES_DB=servas
    volumes:
      - servas-db-data:/var/lib/postgresql/data
    networks:
      - servas-net

# Define named volumes for persistence
volumes:
  servas-db-data:
    driver: local

networks:
  servas-net:
    driver: bridge