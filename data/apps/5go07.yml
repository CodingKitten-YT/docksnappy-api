version: '3.7'

services:
  habitica:
    image: 'habitica/game-server'
    command: server --dev --debug
    container_name: habitica_game_server
    ports:
      - "8085:8080" # Game Server
      - "3000:3000"  # WebSocket (optional, needed if you have clients connected via websockets)
    volumes:
      - './configs/game:/code/game'
      - './data/habitica:/code/storage/habitica'
      - './data/logs:/code/storage/log'
    environment:
      - TZ=Your/Timezone # Set your timezone, e.g., "Europe/London" or "America/New_York"
      - SERVICE_BIND=0.0.0.0 # To allow connections from outside the docker network
      - SERVER_NAME=HabiticaServer # Server name for players to connect
      - ENABLE_ADVENTURES=true # Whether to enable adventures (dungeons)
      - DB_TYPE=postgresql # Database type, use 'sqlite3' for a single player game
      - POSTGRES_HOST=postgres # If using a separate postgres service
      - POSTGRES_USER=habitica # If using a separate postgres service
      - POSTGRES_PASSWORD=secret # If using a separate postgres service
      - POSTGRES_DB=habitica # If using a separate postgres service
    networks:
      - habitica_network

  postgres:
    image: 'postgres:13'
    container_name: habitica_db
    volumes:
      - './data/postgres:/var/lib/postgresql/data'
    environment:
      POSTGRES_USER: habitica
      POSTGRES_PASSWORD: secret
      POSTGRES_DB: habitica
    networks:
      - habitica_network

networks:
  habitica_network:
    driver: bridge