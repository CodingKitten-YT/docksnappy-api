version: '3.8'
services:
  app:
    image: swingmusic/swingmusic:latest
    ports:
      - "8080:8080" # Expose the default port SwingMusic runs on
    environment:
      JVM_OPTS: "-Xms256M -Xmx512M" # Set initial and max heap size for Java VM
      SERVICE_MODE: "standalone" # Operating mode of SwingMusic (e.g., standalone, domain)
    volumes:
      - "./data:/data" # Mount a local data directory to store database files
      - "./config:/config" # Mount a local config directory for custom configuration files
      - "./logs:/logs" # Mount a local logs directory for log files (optional, if you want to keep logs on the host)
    networks:
      - swingmusic_network

  db:
    image: postgres:13
    environment:
      POSTGRES_DB: swingmusic
      POSTGRES_USER: swingmusic
      POSTGRES_PASSWORD: yourpassword # Replace with your actual password
    volumes:
      - "./data/db:/var/lib/postgresql" # Persist database data to a local directory
    networks:
      - swingmusic_network

  redis:
    image: redis:6-alpine
    volumes:
      - "./data/redis:/data" # Persist Redis data to a local directory
    networks:
      - swingmusic_network

networks:
  swingmusic_network:
    driver: bridge