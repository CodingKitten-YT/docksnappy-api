version: '3.7'

services:
  grocy:
    image: 'library/grocy:latest' # Use a specific tag if needed
    container_name: grocy
    ports:
      - "8080:8080" # HTTP port
      - "8443:8443" # HTTPS port (uncomment if you have SSL)
    volumes:
      - './config:/config' # Path to your Grocy configuration, mount for persistence
      - './log:/log'        # Path to a log file directory, mount for logs
      - './data:/data'     # Path to a data directory, mount for database and logs
    environment:
      - PUID=1000 # Replace with your User ID (UID)
      - PGID=1000  # Replace with your Group ID (GID)
      - TZ=Europe/Berlin  # Set your timezone, e.g., Europe/London
      - MYSQL_ROOT_PASSWORD=rootpass  # MySQL root password
      - MYSQL_DATABASE=grocy     # Name of the database to use
      - MYSQL_USER=grocy        # Database user for Grocy
      - MYSQL_PASSWORD=dbpass    # Database password for Grocy
    restart: unless-stopped
    networks:
      - grocy_network

  mysql:
    image: 'mysql:5.7'
    container_name: mysql
    environment:
      - MYSQL_ROOT_PASSWORD=rootpass  # MySQL root password, must match Grocy's MYSQL_ROOT_PASSWORD
      - MYSQL_DATABASE=grocy     # Database to create at initialization
      - MYSQL_USER=grocy        # Database user for Grocy
      - MYSQL_PASSWORD=dbpass    # Database password for Grocy, must match Grocy's MYSQL_PASSWORD
    volumes:
      - './data/mysql:/var/lib/mysql'  # Path to your MySQL data directory, mount for database persistence
    restart: unless-stopped
    networks:
      - grocy_network

  nginx-proxy:
    image: 'nginx:latest'
    container_name: nginx_proxy
    ports:
      - "80:80"   # HTTP port (for NGINX)
      - "443:443"  # HTTPS port (for NGINX)
    volumes:
      - './nginx-data:/etc/nginx'  # Path to store NGINX configuration and certificates
    networks:
      - grocy_network

networks:
  grocy_network:
    driver: bridge