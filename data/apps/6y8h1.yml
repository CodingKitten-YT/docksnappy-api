version: '3.8'
services:
  bunkerweb:
    image: "bunkerapp/bunkerweb:latest" # Use the official BunkerWeb Docker image from Docker Hub
    ports:
      - "8001:80" # Map port 80 of the container to port 8001 on the host for the web interface
    environment:
      - BUNKER_SECRET="your_secret_key" # Set your Bunker secret key for authentication
      - SECRET_MANAGEMENT_URI=http://bunkerweb:8080/api # If using Bunker with Secretly, set the URI for Secretly service
    depends_on:
      - db
      - secrets
    networks:
      - bunkernet

  db:
    image: "postgres:13" # Use PostgreSQL 13 as the database server
    environment:
      - POSTGRES_DB=bunker # Set the default database name for BunkerWeb
      - POSTGRES_USER=bunker # Set the default PostgreSQL username
      - POSTGRES_PASSWORD=your_db_password # Set your database password
    volumes:
      - "bunker-db:/var/lib/postgresql" # Persist database data using Docker volume
    networks:
      - bunkernet

  secrets:
    image: "bunkerapp/secrets:latest" # Use the official BunkerSecrets Docker image for secret storage
    environment:
      - SECRETS_DB_URI="postgres://bunker:your_db_password@db:5432/bunker?sslmode=disable" # Database connection string for BunkerSecrets
    networks:
      - bunkernet

networks:
  bunkernet:
    driver: bridge

volumes:
  bunker-db: