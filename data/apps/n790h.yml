version: '3.8'

services:
  handbrake-web:
    image: handbrake/handbrake-web:latest  # Use the official HandBrake Web image
    ports:
      - "8080:80"  # Map HTTP port 80 to port 80 on the container for web access
    volumes:
      - "./upload:/usr/src/app/upload"  # Mount a local directory for file uploads (adjust the path as needed)
      - "./handbrake.json:/usr/src/app/handbrake.json:ro"  # Optionally mount a custom handbrake.json configuration file (read-only)
    environment:
      - TZ="Europe/London"  # Set the timezone (change to your desired timezone)
    restart: unless-stopped  # Ensure the container restarts on failure

  redis:
    image: redis:6-alpine  # Redis cache for HandBrake Web tasks
    volumes:
      - redistoragedata:redisdata  # Persist Redis data (optional, recommended for production)

volumes:
  redistoragedata: