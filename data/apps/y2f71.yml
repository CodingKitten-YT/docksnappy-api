version: '3.8'
services:
  app:
    image: "flyimg/app:latest" # Use the official Flyimg app image or a specific tag if needed
    ports:
      - "8080:8080" # Expose the port the application runs on (default is usually 8080)
    environment:
      - API_KEY=your_api_key # Set your Flyimg API key for authentication
      - DATABASE_URL=postgres://user:password@db:5432/dbname # Database connection string
      - REDIS_URL=redis://user:password@redis:6379/0 # Redis connection string if used
    volumes:
      - ./app:/app # Mount your local app directory to the container for code changes
      - app-data:/data # Mount a named volume for persistent data (e.g., uploads, etc.)
    depends_on:
      - db
      - redis
    networks:
      - flyimg-network

  db:
    image: "postgres:latest" # Use the official PostgreSQL image
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=dbname
    volumes:
      - db-data:/var/lib/postgresql/data # Mount a named volume for persistent database data
    networks:
      - flyimg-network

  redis:
    image: "redis:latest" # Use the official Redis image
    networks:
      - flyimg-network

volumes:
  app-data:
  db-data:

networks:
  flyimg-network: