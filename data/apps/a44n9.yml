version: '3.7'

services:
  cerbos:
    image: cerbos/cerbos:latest  # or use a specific tag if you need a stable version
    ports:
      - "8501:8501"  # Cerbos default gRPC port (internal)
      - "9000:9000"   # Cerbos UI for visualization of policies and access control contexts
    command: ["-server", "--allow-root"]
    environment:
      ALLOW_ROOT_USER: "true"  # This is for local development/testing only, not recommended for production
    networks:
      - cerbos_network

  postgres:
    image: postgres:latest  # or use a specific tag if you need a stable version
    volumes:
      - cerbos-postgres-data:/var/lib/postgresql
    environment:
      POSTGRES_DB: cerbos
      POSTGRES_USER: cerbos
      POSTGRES_PASSWORD: cerbos-secret  # You should use a proper secret management system in production
    networks:
      - cerbos_network

volumes:
  cerbos-postgres-data:
    driver: local

networks:
  cerbos_network:
    name: cerbos_network