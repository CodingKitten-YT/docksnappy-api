version: '3.8'

services:
  heyform_web:
    image: heyform/heyform:latest
    ports:
      - "80:80" # Map HTTP port 80 on the host to port 80 in the container
    environment:
      HEYFORM_SECRET_KEY: 'your_secret_key' # Replace with a secret key for production use
      HEYFORM_DB_HOST: db  # Database service name
      HEYFORM_DB_NAME: heyform  # Database name
      HEYFORM_DB_USER: root  # Database user
      HEYFORM_DB_PASSWORD: your_db_password  # Replace with your database password
      HEYFORM_DB_ENGINE: postgres  # Database engine (e.g., postgres, mysql)
      HEYFORM_ADMINS: 'admin@example.com'  # List of admin emails
      HEYFORM_EMAIL_HOST: smtp
      HEYFORM_EMAIL_PORT: 587
      HEYFORM_EMAIL_USER: your_email@example.com  # Your email address
      HEYFORM_EMAIL_PASSWORD: your_email_password  # Your email password
    depends_on:
      - heyform_db
      - heyform_mailhog
    volumes:
      - ./heyform/data:/data
      - ./heyform/static:/app/heyform/public/static

  heyform_db:
    image: postgres:latest
    volumes:
      - db_data:/var/lib/postgresql/data
    environment:
      POSTGRES_DB: heyform
      POSTGRES_USER: root
      POSTGES_PASSWORD: your_db_password  # Replace with your database password

  heyform_mailhog:
    image: mailhog/mailhog:latest
    ports:
      - "1025:1025" # Map local SMTP port 1025 for MailHog to the container's port 1025
      - "8025:8025" # Map web UI port 8025 for MailHog to the container's port 8025
    environment:
      MAILHOG_INCOMING_HOST_WHITELIST: 'localhost'

volumes:
  db_data: