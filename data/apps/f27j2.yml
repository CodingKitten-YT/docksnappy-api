version: '3.8'

services:
  litecart:
    image: 'litemage/litecart:latest' # Use the official LiteCart Docker image
    ports:
      - "80:80" # Map HTTP port 80 on host to container
      - "443:443" # Map HTTPS port 443 on host to container (optional, if you want to use SSL)
    volumes:
      - ./litecart/conf:/var/www/htdocs/config
      - ./litecart/logs:/var/log/litecart
      - ./litecart/cache:/var/cache/litecart
      - ./litecart/var:/var/www/htdocs/var
      - ./litecart/ssl:/var/www/htdocs/apps/secure.shop/data/ssl # (optional, if you want to use SSL)
    depends_on:
      - mysql
    networks:
      default:
        alias: litecart

  mysql:
    image: 'mysql:5.7'
    volumes:
      - litecart_dbdata:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: litecart
      MYSQL_USER: litecartuser
      MYSQL_PASSWORD: litecartpassword
    networks:
      default:
        alias: database

  php-fpm:
    image: 'litemage/litecart-php74-fpm:latest' # Use the official PHP FPM Docker image for LiteCart
    volumes:
      - ./litecart/conf:/var/www/htdocs/config
      - ./litecart/logs:/var/log/litecart
      - ./litecart/cache:/var/cache/litecart
      - ./litecart/var:/var/www/htdocs/var
      - ./litecart/web:/var/www/htdocs/apps/code/upload # (optional, if you want to map the web directory)
    depends_on:
      - litecart
      - mysql
    networks:
      default:
        alias: php-fpm

  nginx-proxy:
    image: 'jwilder/nginx-proxy':latest
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./litecart/nginx/conf.d:/etc/nginx/conf.d
      - ./litecart/nginx/certs:/etc/nginx/ssl
      - ./litecart/nginx/data:/var/lib/nginx-proxy
    depends_on:
      - litecart
      - php-fpm
    networks:
      default:
        alias: nginx-proxy

networks:
  default:
    external: true

volumes:
  litecart_dbdata:
    driver: local