version: '3.8'
services:
  bracket_api:
    image: "bracketjs/bracket-api"
    ports:
      - "5000:5000" # Bracket API server runs on port 5000 by default
    environment:
      CONFIG_FILE: /config.json # Path to your custom config file if you have one
      DATABASE_HOST: db              # Service name of the database container
      POSTGRES_DB: bracket          # Database name for PostgreSQL
      POSTGRES_USER: bracket         # Database user for PostgreSQL
      POSTGRES_PASSWORD: yourpassword  # Database password for PostgreSQL
    volumes:
      - ./bracket-api.env:/config.env # Load custom environment variables from a file (optional)
    depends_on:
      - db
    networks:
      - bracket_network

  db:
    image: "postgres:13"             # Use the official PostgreSQL image
    volumes:
      - postgres_data:/var/lib/postgresql # Persist database data
    environment:
      POSTGRES_DB: bracket          # Database name
      POSTGRES_USER: bracket         # Database user
      POSTGRES_PASSWORD: yourpassword  # Database password
    networks:
      - bracket_network

# named volumes for persistence
volumes:
  postgres_data:

networks:
  bracket_network: