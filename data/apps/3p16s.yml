version: '3.8'

services:
  fluidd:
    image: fluidd/fluidd:latest # Use the official Fluidd image from Docker Hub
    container_name: fluidd
    ports:
      - "6061:6061" # HTTP API
      - "6062:6062" # WebUI (optional, if you want to access it from the host)
    volumes:
      - "./fluidd.db:/data/fluidd.db" # Persist the Fluidd database
      - "./config:/config" # Persist the Fluidd configuration directory
      - "./plugins:/plugins" # Persist user plugins if you want to use them
    environment:
      FLUIDD_API_VK_LISTEN: "all" # Listen for API calls from all interfaces
      FLUIDD_API_HTTP_LISTEN: "0.0.0.0:6061" # HTTP API listen address (optional, if you want to change it)
      FLUIDD_WEB_UI_LISTEN: "0.0.0.0:6062" # Web UI listen address (optional, if you want to change it)
      TZ: "Europe/London" # Set the timezone (change to your preferred timezone)
    restart: unless-stopped # Restart the service unless it's been explicitly stopped

  postgres:
    image: postgres:latest # Use the official PostgreSQL image from Docker Hub
    environment:
      POSTGRES_USER: fluidd
      POSTGRES_PASSWORD: fluiddpasswd
      POSTGRES_DB: fluidd
    volumes:
      - "./fluidd.db:/var/lib/postgresql/data/fluidd.db" # Persist the PostgreSQL database (optional, if you want to use a persistent volume for the DB)
    environment:
      POSTGRES_DB: fluidd
      POSTGRES_USER: fluidd
      POSTGRES_PASSWORD: fluiddpasswd

  redis:
    image: redis:latest # Use the official Redis image from Docker Hub
    volumes:
      - "./redis.conf:/etc/redis/redis.conf" # Persist Redis configuration (optional, if you want to customize it)

networks:
  fluidd_net:
    driver: bridge